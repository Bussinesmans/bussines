<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InstaParser - –ê–Ω–∞–ª–∏–∑ Instagram</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 30px; padding: 20px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .analyzer-card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
        input { flex: 1; padding: 15px 20px; border: 2px solid #e1e1e1; border-radius: 10px; font-size: 16px; }
        button { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 16px; cursor: pointer; }
        button:disabled { opacity: 0.6; cursor: not-allowed; }
        .results { margin-top: 30px; }
        .section { margin-bottom: 25px; }
        .section-title { font-size: 1.5rem; color: #333; margin-bottom: 15px; }
        .post-card { background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 15px; border-left: 4px solid #667eea; }
        .hashtag-list { display: flex; flex-wrap: wrap; gap: 10px; }
        .hashtag { background: #e9ecef; padding: 8px 15px; border-radius: 20px; font-size: 14px; }
        .loading { text-align: center; padding: 20px; display: none; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .stats { background: #e3f2fd; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .error { background: #ffebee; padding: 20px; border-radius: 10px; color: #c53030; }
        .success { background: #f0fff4; padding: 20px; border-radius: 10px; color: #2d7741; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç InstaParser</h1>
            <p>–ê–Ω–∞–ª–∏–∑ Instagram –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>

        <div class="analyzer-card">
            <div class="input-group">
                <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ Instagram username (–±–µ–∑ @)" value="instagram">
                <button onclick="analyzeAccount()" id="analyzeBtn">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>–ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Instagram...</p>
            </div>

            <div class="results" id="results"></div>
        </div>
    </div>

    <script>
        // üî• –ó–ê–ú–ï–ù–ò –≠–¢–£ –°–°–´–õ–ö–£ –ù–ê –°–í–û–Æ –ò–ó GOOGLE SCRIPTS
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/–¢–í–û–ô_–ò–î–ï–ù–¢–ò–§–ò–ö–ê–¢–û–†/exec';

        async function analyzeAccount() {
            const username = document.getElementById('username').value.trim();
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');

            if (!username) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ username Instagram', 'error');
                return;
            }

            analyzeBtn.disabled = true;
            loading.style.display = 'block';
            results.innerHTML = '';

            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?username=${encodeURIComponent(username)}`);
                const data = await response.json();
                
                if (data.success) {
                    displayResults(data);
                } else {
                    showMessage(data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞', 'error');
                }
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
            }

            analyzeBtn.disabled = false;
            loading.style.display = 'none';
        }

        function displayResults(data) {
            const results = document.getElementById('results');
            
            let html = `
                <div class="stats">
                    <h2>üìä @${data.username}</h2>
                    <p><strong>${data.full_name || ''}</strong></p>
                    <div style="display: flex; gap: 20px; margin-top: 10px; flex-wrap: wrap;">
                        <span>üë• ${data.followers?.toLocaleString() || 'N/A'} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</span>
                        <span>üìù ${data.posts_count || 'N/A'} –ø–æ—Å—Ç–æ–≤</span>
                        <span>üïí ${data.analyzed_at}</span>
                    </div>
                </div>
            `;
            
            // –¢–æ–ø –ø–æ—Å—Ç–æ–≤
            html += `<div class="section"><h3 class="section-title">üéØ –¢–û–ü-5 –ü–û–°–¢–û–í –ü–û –õ–ê–ô–ö–ê–ú</h3>`;
            
            if (data.top_posts && data.top_posts.length > 0) {
                data.top_posts.forEach((post, index) => {
                    const postType = post.is_video ? 'üé¨ REELS' : 'üì∑ –§–æ—Ç–æ';
                    html += `
                        <div class="post-card">
                            <strong>#${index + 1} | ${postType} | ‚ù§Ô∏è ${post.likes?.toLocaleString() || 0} –ª–∞–π–∫–æ–≤ | üí¨ ${post.comments || 0} –∫–æ–º–º–µ–Ω—Ç–æ–≤</strong>
                            ${post.caption ? `<p style="margin-top: 8px; color: #555;">${post.caption}</p>` : ''}
                            <small>üìÖ ${post.date}</small>
                        </div>
                    `;
                });
            } else {
                html += `<p>–ü–æ—Å—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>`;
            }
            html += `</div>`;
            
            // –•–µ—à—Ç–µ–≥–∏
            html += `<div class="section"><h3 class="section-title">üè∑Ô∏è –ü–û–ü–£–õ–Ø–†–ù–´–ï –•–ï–®–¢–ï–ì–ò</h3>`;
            html += `<div class="hashtag-list">`;
            
            if (data.popular_hashtags && data.popular_hashtags.length > 0) {
                data.popular_hashtags.forEach(tag => {
                    html += `<span class="hashtag">${tag}</span>`;
                });
            } else {
                html += `<p>–•–µ—à—Ç–µ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>`;
            }
            html += `</div></div>`;
            
            results.innerHTML = html;
        }

        function showMessage(message, type) {
            const results = document.getElementById('results');
            results.innerHTML = `<div class="${type}">${message}</div>`;
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ Enter
        document.getElementById('username').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') analyzeAccount();
        });

        // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            const results = document.getElementById('results');
            results.innerHTML = `
                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                    <h3>üí° –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li>–í–≤–µ–¥–∏—Ç–µ username Instagram (–Ω–∞–ø—Ä–∏–º–µ—Ä: instagram, natgeo)</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"</li>
                        <li>–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–ø –ø–æ—Å—Ç–æ–≤ –∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ö–µ—à—Ç–µ–≥–∏</li>
                    </ol>
                    <p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong> –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</p>
                </div>
            `;
        }
    </script>
</body>
</html>
